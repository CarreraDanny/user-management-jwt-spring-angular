<div class="form-user-container">
  <h2>Agregar Nuevo Usuario</h2>

  <form (ngSubmit)="addUser()" #userForm="ngForm">
    <div class="form-group">
      <label for="name">Nombre</label>
      <input type="text" id="name" name="name" [(ngModel)]="user.name" (ngModelChange)="clearServerError('name')" placeholder="Ingresa el nombre"
             required minlength="2" maxlength="100" pattern="[a-zA-Z\s]+" #name="ngModel"
             [class.invalid]="name.invalid && name.touched" />
      <span class="error show" *ngIf="name.touched && name.errors?.['required']">Nombre es obligatorio</span>
      <span class="error show" *ngIf="name.touched && name.errors?.['minlength']">Mínimo 2 caracteres</span>
      <span class="error show" *ngIf="name.touched && name.errors?.['maxlength']">Máximo 100 caracteres</span>
      <span class="error show" *ngIf="name.touched && name.errors?.['pattern']">Nombre solo puede contener letras y espacios</span>
      <span class="error show" *ngIf="serverErrors['name']">{{ serverErrors['name'] }}</span>
    </div>

    <div class="form-group">
      <label for="lastName">Apellido</label>
      <input type="text" id="lastName" name="lastName" [(ngModel)]="user['lastName']" (ngModelChange)="clearServerError('lastName')" placeholder="Ingresa el apellido"
             required minlength="2" maxlength="100" pattern="[a-zA-Z\s]+" #lastName="ngModel"
             [class.invalid]="lastName.invalid && lastName.touched" />
      <span class="error show" *ngIf="lastName.touched && lastName.errors?.['required']">Apellido es obligatorio</span>
      <span class="error show" *ngIf="lastName.touched && lastName.errors?.['minlength']">Mínimo 2 caracteres</span>
      <span class="error show" *ngIf="lastName.touched && lastName.errors?.['maxlength']">Máximo 100 caracteres</span>
      <span class="error show" *ngIf="lastName.touched && lastName.errors?.['pattern']">Apellido solo puede contener letras y espacios</span>
      <span class="error show" *ngIf="serverErrors['lastName']">{{ serverErrors['lastName'] }}</span>
    </div>

    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email" name="email" [(ngModel)]="user.email" (ngModelChange)="clearServerError('email')" placeholder="Ingresa el email"
             required email #email="ngModel"
             [class.invalid]="email.invalid && email.touched" />
      <span class="error show" *ngIf="email.touched && email.errors?.['required']">El email es obligatorio</span>
      <span class="error show" *ngIf="email.touched && email.errors?.['email']">Ingresa un email válido</span>
      <span class="error show" *ngIf="serverErrors['email']">{{ serverErrors['email'] }}</span>
    </div>

    <div class="form-group">
      <label for="username">Usuario</label>
      <input type="text" id="username" name="username" [(ngModel)]="user.username" (ngModelChange)="clearServerError('username')" placeholder="Ingresa el usuario"
             required minlength="3" maxlength="50" pattern="[a-zA-Z0-9_]+" #username="ngModel"
             [class.invalid]="username.invalid && username.touched" />
      <span class="error show" *ngIf="username.touched && username.errors?.['required']">El usuario es obligatorio</span>
      <span class="error show" *ngIf="username.touched && username.errors?.['minlength']">Mínimo 3 caracteres</span>
      <span class="error show" *ngIf="username.touched && username.errors?.['maxlength']">Máximo 50 caracteres</span>
      <span class="error show" *ngIf="username.touched && username.errors?.['pattern']">Usuario solo puede contener letras, números y guion bajo</span>
      <span class="error show" *ngIf="serverErrors['username']">{{ serverErrors['username'] }}</span>
    </div>

    <div class="form-group">
      <label for="password">Contraseña</label>
      <input type="password" id="password" name="password" [(ngModel)]="user.password" (ngModelChange)="clearServerError('password')" placeholder="Ingresa la contraseña"
             required minlength="6" #password="ngModel"
             [class.invalid]="password.invalid && password.touched" />
      <span class="error show" *ngIf="password.touched && password.errors?.['required']">La contraseña es obligatoria</span>
      <span class="error show" *ngIf="password.touched && password.errors?.['minlength']">Contraseña mínima 6 caracteres</span>
      <span class="error show" *ngIf="serverErrors['password']">{{ serverErrors['password'] }}</span>
    </div>

    <button type="submit" [disabled]="userForm.invalid">Guardar</button>
  </form>
</div>
